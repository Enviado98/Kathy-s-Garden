<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Saitama Serious Mode</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            width: 100vw;
            height: 100vh;
            background-color: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        #container {
            position: relative;
            width: 90vmin; /* Se adapta a la pantalla */
            height: 90vmin;
            /* Debug: border: 1px solid red; */
        }

        /* 1. LA IMAGEN BASE */
        #saitama-img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            transition: filter 0.5s;
        }

        /* 2. CAPA DE OSCURIDAD (Velo) */
        /* Cubre la imagen pero estará DEBAJO de los ojos blancos recreados */
        #darkness-layer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.7); /* Oscuridad intensa */
            mix-blend-mode: multiply;
            opacity: 0; /* Invisible al inicio */
            pointer-events: none;
            z-index: 10;
            transition: opacity 1s ease;
        }

        /* 3. RECREACIÓN DE LOS OJOS (Para que brillen) */
        .eye-wrapper {
            position: absolute;
            background: #fff; /* El blanco del ojo */
            overflow: hidden; /* Para que la pupila no se salga */
            z-index: 20; /* Encima de la oscuridad */
            box-shadow: 0 0 0px rgba(255, 255, 255, 0); /* Glow apagado */
        }

        /* Ajuste manual para coincidir con la imagen */
        #eye-left {
            top: 25%;
            left: 36%;
            width: 13%;
            height: 10%;
            border-radius: 50% 50% 40% 40%;
            transform: rotate(5deg);
        }

        #eye-right {
            top: 29%;
            left: 59%;
            width: 12%;
            height: 9%;
            border-radius: 50% 50% 40% 40%;
            transform: rotate(-5deg);
        }

        /* 4. PUPILAS */
        .pupil {
            position: absolute;
            background: #000;
            border-radius: 50%;
            width: 12%; 
            height: 16%;
            /* Posición inicial: "Mirando a lo lejos" (Desviadas) */
            top: 40%; 
            left: 20%; 
            transition: transform 0.1s;
        }

        /* 5. CAPA DE RAYOS (Flash) */
        #lightning-flash {
            position: fixed;
            top: 0; left: 0; width: 100vw; height: 100vh;
            background: white;
            opacity: 0;
            pointer-events: none;
            z-index: 100; /* Encima de todo */
            mix-blend-mode: overlay;
        }

        /* INSTRUCCIONES */
        .hint {
            position: absolute;
            bottom: 20px;
            font-family: monospace;
            color: #555;
            opacity: 0.6;
        }

    </style>
</head>
<body>

    <div id="container">
        <!-- Usa tu imagen aquí. Si la guardas local, cambia el src -->
        <img id="saitama-img" src="https://raw.githubusercontent.com/Enviado98/Kathy-s-Garden/refs/heads/main/images.png" alt="Saitama">
        
        <!-- Capa oscura -->
        <div id="darkness-layer"></div>

        <!-- Ojos superpuestos (Recreados para control total) -->
        <div id="eye-left" class="eye-wrapper">
            <div class="pupil"></div>
        </div>
        <div id="eye-right" class="eye-wrapper">
            <div class="pupil"></div>
        </div>
    </div>

    <!-- Flash de rayos -->
    <div id="lightning-flash"></div>

    <div class="hint">Doble toque para molestar</div>

    <script>
        // Referencias
        const pupils = document.querySelectorAll('.pupil');
        const darkness = document.getElementById('darkness-layer');
        const lightning = document.getElementById('lightning-flash');
        const eyeWrappers = document.querySelectorAll('.eye-wrapper');
        
        let isSerious = false;
        let lightningInterval = null;

        // ANIMACIÓN DE "A LO LEJOS" (Idle)
        // Las pupilas se mueven muy poquito como si estuviera distraído
        function idleGaze() {
            if(isSerious) return;
            
            // Movimiento aleatorio suave en la esquina (mirando a la nada)
            gsap.to(pupils, {
                xPercent: "random(-10, 10)",
                yPercent: "random(-10, 10)",
                duration: 2,
                ease: "sine.inOut",
                onComplete: idleGaze
            });
        }
        
        // Iniciar mirada distraída
        // Posicionamos las pupilas mirando "a lo lejos" (arriba izquierda, por ejemplo)
        gsap.set(pupils, { left: '20%', top: '30%' });
        idleGaze();


        // EVENTO: DOBLE TOQUE
        let lastTap = 0;
        document.body.addEventListener('click', (e) => {
            const currentTime = new Date().getTime();
            const tapLength = currentTime - lastTap;
            
            if (tapLength < 500 && tapLength > 0) {
                // DOBLE TAP DETECTADO
                if(!isSerious) triggerSeriousMode();
            }
            lastTap = currentTime;
        });


        function triggerSeriousMode() {
            isSerious = true;
            gsap.killTweensOf(pupils); // Detener animación idle

            // 1. OSCURIDAD: El fondo se oscurece
            gsap.to(darkness, { opacity: 0.9, duration: 2 });

            // 2. PUPILAS: Se mueven LENTO y SUAVE hacia el espectador (Centro)
            // Calculamos el centro del ojo (aprox 45% left, 45% top para centrar el punto)
            gsap.to(pupils, {
                left: '44%', // Centro horizontal del ojo
                top: '42%',  // Centro vertical del ojo
                xPercent: 0, // Resetear offsets del idle
                yPercent: 0,
                scale: 1.2, // Se dilatan un poco (intensidad)
                duration: 2.5, // Muy lento, intimidante
                ease: "power2.inOut"
            });

            // 3. SECUENCIA DE RAYOS
            // Esperamos un poco a que empiece a mirar para soltar los rayos
            setTimeout(() => {
                startLightningStorm();
            }, 1000);

            // 4. RESET (Opcional, vuelve a la normalidad después de 8 segundos)
            setTimeout(() => {
                resetMode();
            }, 8000);
        }

        function startLightningStorm() {
            // Función recursiva para rayos aleatorios
            const flash = () => {
                if(!isSerious) return;

                // Intensidad aleatoria del rayo
                const intensity = Math.random(); 
                
                // 1. El Flash de pantalla
                gsap.to(lightning, {
                    opacity: intensity * 0.6, // Flash blanco
                    duration: 0.05,
                    yoyo: true,
                    repeat: 1,
                    onComplete: () => {
                        // Próximo rayo en tiempo aleatorio (rápido o lento)
                        if(isSerious) setTimeout(flash, Math.random() * 1000 + 200);
                    }
                });

                // 2. EL BRILLO DE LOS OJOS (Sincronizado con el rayo)
                // Cuando hay rayo, los ojos brillan más
                if (intensity > 0.5) {
                    gsap.to(eyeWrappers, {
                        boxShadow: `0 0 20px 5px rgba(255, 255, 255, 0.9)`, // Glow intenso
                        duration: 0.05,
                        yoyo: true,
                        repeat: 1
                    });
                }
            };
            flash();
        }

        function resetMode() {
            isSerious = false;

            // Quitar oscuridad
            gsap.to(darkness, { opacity: 0, duration: 2 });
            
            // Quitar glow de ojos si quedó
            gsap.to(eyeWrappers, { boxShadow: "0 0 0px rgba(255,255,255,0)", duration: 0.5 });

            // Pupilas vuelven a mirar "a la nada"
            gsap.to(pupils, {
                left: '20%',
                top: '30%',
                scale: 1,
                duration: 2,
                ease: "power2.inOut",
                onComplete: idleGaze // Reactivar idle
            });
        }

        // --- AJUSTE RESPONSIVO ---
        // (Para asegurar que los ojos calcen bien si la ventana cambia)
        window.addEventListener('resize', () => {
            // GSAP handles transforms well, no specific reload needed usually
        });

    </script>
</body>
</html>
