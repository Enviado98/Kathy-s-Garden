<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Saitama Real Eyes</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            width: 100vw;
            height: 100vh;
            background-color: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        #container {
            position: relative;
            width: 90vmin; 
            height: 90vmin;
        }

        /* 1. IMAGEN BASE */
        #saitama-img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            position: relative;
            z-index: 1;
        }

        /* 2. CAPA DE OSCURIDAD */
        #darkness-layer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.85); /* Más oscuro */
            mix-blend-mode: multiply; /* Se fusiona mejor con el dibujo */
            opacity: 0;
            pointer-events: none;
            z-index: 10; /* Encima de la imagen */
            transition: opacity 1s ease;
        }

        /* 3. ENVOLTORIO DE OJOS (MÁSCARA) */
        .eye-wrapper {
            position: absolute;
            /* AQUÍ ESTÁ EL CAMBIO: Fondo transparente */
            background: transparent; 
            
            /* Esto recorta la pupila para que no se salga del ojo */
            overflow: hidden; 
            
            z-index: 20; /* Encima de la oscuridad */
            
            /* Forma aproximada para que coincida con el dibujo */
            /* Si las pupilas se cortan antes de tiempo, ajusta width/height */
        }

        /* Ajuste de posición (calibrado para la imagen de Saitama) */
        #eye-left {
            top: 25%; left: 37%;
            width: 12%; height: 10%;
            border-radius: 40% 50% 40% 40%;
            transform: rotate(5deg);
        }

        #eye-right {
            top: 29%; left: 60%;
            width: 11%; height: 9%;
            border-radius: 40% 50% 40% 40%;
            transform: rotate(-5deg);
        }

        /* 4. PUPILAS */
        .pupil {
            position: absolute;
            background: #000; /* Negras */
            border-radius: 50%;
            width: 15%;  /* Tamaño pupila */
            height: 20%;
            /* Posición inicial distraída */
            top: 30%; 
            left: 20%; 
            opacity: 0.9;
        }

        /* 5. FLASH DE RAYOS */
        #lightning-flash {
            position: fixed;
            top: 0; left: 0; width: 100vw; height: 100vh;
            background: #fff;
            opacity: 0;
            pointer-events: none;
            z-index: 100;
            mix-blend-mode: screen;
        }

        .hint {
            position: absolute; bottom: 20px; font-family: monospace; color: #555; opacity: 0.5;
        }
    </style>
</head>
<body>

    <div id="container">
        <!-- Reemplaza con tu imagen local o URL -->
        <img id="saitama-img" src="https://raw.githubusercontent.com/Enviado98/Kathy-s-Garden/refs/heads/main/images.png" alt="Saitama">
        
        <div id="darkness-layer"></div>

        <!-- Ojos Transparentes (Solo contienen la pupila y cortan los bordes) -->
        <div id="eye-left" class="eye-wrapper"><div class="pupil"></div></div>
        <div id="eye-right" class="eye-wrapper"><div class="pupil"></div></div>
    </div>

    <div id="lightning-flash"></div>
    <div class="hint">Doble toque en pantalla</div>

    <script>
        const pupils = document.querySelectorAll('.pupil');
        const eyeWrappers = document.querySelectorAll('.eye-wrapper');
        const darkness = document.getElementById('darkness-layer');
        const lightning = document.getElementById('lightning-flash');
        
        let isSerious = false;

        // ANIMACIÓN "DISTRAÍDO" (IDLE)
        function idleGaze() {
            if(isSerious) return;
            // Movimiento errático y lento
            gsap.to(pupils, {
                xPercent: "random(-15, 15)",
                yPercent: "random(-15, 15)",
                duration: 2.5,
                ease: "sine.inOut",
                onComplete: idleGaze
            });
        }
        // Iniciar mirada desviada
        gsap.set(pupils, { left: '20%', top: '35%' });
        idleGaze();

        // DOBLE TOQUE
        let lastTap = 0;
        document.body.addEventListener('click', (e) => {
            const currentTime = new Date().getTime();
            const tapLength = currentTime - lastTap;
            if (tapLength < 500 && tapLength > 0) {
                if(!isSerious) activateSeriousMode();
            }
            lastTap = currentTime;
        });

        function activateSeriousMode() {
            isSerious = true;
            gsap.killTweensOf(pupils);

            // 1. OSCURIDAD DEL FONDO
            gsap.to(darkness, { opacity: 0.9, duration: 1.5 });

            // 2. HACER QUE LOS OJOS RESALTEN (Glow sutil)
            // Como el wrapper es transparente, le damos un fondo blanco suave
            // para que los ojos no se vean grises por la oscuridad
            gsap.to(eyeWrappers, { 
                backgroundColor: "rgba(255, 255, 255, 0.2)", 
                boxShadow: "0 0 15px rgba(255,255,255,0.3)",
                duration: 0.5 
            });

            // 3. PUPILAS AL CENTRO (Mirada Fija)
            gsap.to(pupils, {
                left: '42%', // Centro geométrico aprox
                top: '40%',
                xPercent: 0,
                yPercent: 0,
                scale: 1.3, // Pupila se dilata
                duration: 3, // Muy lento
                ease: "power2.inOut"
            });

            // 4. RAYOS
            setTimeout(lightningStorm, 800);

            // 5. RESET AUTOMÁTICO
            setTimeout(resetMode, 7000);
        }

        function lightningStorm() {
            const flash = () => {
                if(!isSerious) return;
                const intensity = Math.random();

                // Flash pantalla completa
                gsap.to(lightning, {
                    opacity: intensity * 0.5,
                    duration: 0.05,
                    yoyo: true, repeat: 1,
                    onComplete: () => {
                        if(isSerious) setTimeout(flash, Math.random() * 800 + 100);
                    }
                });

                // Brillo extra en los ojos cuando cae rayo
                if(intensity > 0.6) {
                    gsap.to(eyeWrappers, {
                        backgroundColor: "rgba(255, 255, 255, 0.9)", // Se ponen blancos brillantes
                        boxShadow: "0 0 25px rgba(255,255,255, 1)",
                        duration: 0.05,
                        yoyo: true, repeat: 1
                    });
                }
            };
            flash();
        }

        function resetMode() {
            isSerious = false;
            // Quitar oscuridad
            gsap.to(darkness, { opacity: 0, duration: 2 });
            
            // Quitar brillo de ojos (vuelven a transparente)
            gsap.to(eyeWrappers, { 
                backgroundColor: "transparent", 
                boxShadow: "none", 
                duration: 1 
            });

            // Pupilas vuelven a distraerse
            gsap.to(pupils, {
                left: '20%', top: '35%', scale: 1,
                duration: 2, ease: "power2.inOut",
                onComplete: idleGaze
            });
        }
    </script>
</body>
</html>
